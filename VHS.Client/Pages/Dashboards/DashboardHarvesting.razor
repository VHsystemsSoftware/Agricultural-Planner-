@page "/dashboard-harvesting"
@inject HubConnection _hubConnection
@inject PageTitleService PageTitleService
@implements IDisposable

<DashboardComponent JobLocationId="@GlobalConstants.JOBLOCATION_HARVESTER" @ref="dc" />

@code {
	private DashboardComponent? dc;

	protected override async Task OnInitializedAsync()
	{
		PageTitleService.Title = "";
		PageTitleService.BackUrl = "";

		await ConnectNotification();
	}

	private async Task ConnectNotification()
	{
		_hubConnection.On("RefreshDashboardHarvester", () =>
		 {
			 dc.LoadJobs();
		 });

	}

	public void Dispose()
	{
		if (_hubConnection != null)
		{
			_hubConnection.Remove("RefreshDashboardHarvester");
		}
	}
}

